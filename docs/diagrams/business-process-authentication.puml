@startuml business-process-authentication
title Business Process: User Authentication & Session Management

!include skinparams.puml

|User|
start
:Access Login Page;

|System|
:Display Login Form;
note right
  • CSRF token is generated
  • Rate limiter is initialized
end note

|User|
:Submit Credentials;

|System|
:Attempt Login;
note right
  A series of security checks are performed:
  • CSRF token validation
  • Rate limit check
  • User and account status lookup
  • Password verification (bcrypt)
end note

if (Login Successful?) then (yes)
  :Establish Session;
  note right
    • Reset failed login attempts
    • Generate secure session token
    • Store session in database
    • Create HttpOnly cookie
    • Log successful login event
  end note
  
  |User|
  :Redirect to Dashboard;
  stop
else (no)
  :Handle Failed Login;
  note right
    On failure, the system will:
    • Log the security event (e.g., failed CSRF, rate limit, bad password)
    • Increment failed attempts
    • Lock account if max attempts is reached
    • Display a generic error to the user
  end note
  stop
endif

@enduml
